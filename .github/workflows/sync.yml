on:
  push:
    branches: main
    paths:
      - "byoc-nuon/**"
  workflow_dispatch:
    inputs:
      NUON_DEBUG:
       description: NUON_DEBUG
       required: true
       default: "false"
       type: choice
       options:
       - true
       - false
defaults:
  run:
    shell: bash
env:
  NUON_ORG_ID: ${{ secrets.NUON_ORG_ID }}
  NUON_API_TOKEN: ${{ secrets.NUON_API_TOKEN }}
  NUON_DEBUG: "${{ github.event.inputs.NUON_DEBUG }}"

jobs:
  sync:
    runs-on: ubuntu-latest
    name: Push to Nuon
    steps:
      - name: Checkout code
        uses: actions/checkout@v3
      - name: Install CLI
        id: cli
        run: ./scripts/install-cli.sh
      - name: Change Directory
        id: cd
        run: |
          cd byoc-nuon
          pwd
          tree
      - name: Sync configs
        id: sync
        run: |
          cd byoc-nuon
          echo "syncing from inside directory: "`pwd`
          nuon apps sync-dir .
